name: Latest repositories workflow

on:
  schedule:
    - cron: '0 * * * *' # Executar o fluxo de trabalho automaticamente a cada hora, na hora
  workflow_dispatch: # Executar o fluxo de trabalho manualmente

permissions:
  contents: write # Para escrever os conteúdos gerados no arquivo README

jobs:
  update-readme-with-repos:
    name: Update README with latest repositories
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '14'
      - name: Install jq
        run: sudo apt-get install jq
      - name: Pull in latest repositories and update README
        run: |
          curl -s "https://api.github.com/users/${{ github.actor }}/repos?per_page=5&sort=created" | jq -r '.[].name' > temp.txt
          echo "## Últimos Repositórios" > README_temp.md
          while IFS= read -r line; do
            echo "- $line" >> README_temp.md
          done < temp.txt
          sed -i '/## Últimos Repositórios/,$d' README.md
          cat README_temp.md >> README.md
          rm temp.txt README_temp.md
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
